<html>
    <body>
    <div class="wrapper">
      <div class="content">
        <div class="container-fluid mt-5">
          <div class="row d-flex justify-content-center">
            <div class="col-md-7">
              <div class="card p-3 py-4">
                <div class="text-center">
                  <img src="https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fdefinicion.de%2Fwp-content%2Fuploads%2F2019%2F07%2Fperfil-de-usuario.png&f=1&nofb=1&ipt=e34c3b998655298d36e17f0c0fcfbe5afbd2ed41f2bae4ed1c1b5ccfa088835f&ipo=images" class="profile-image">
                </div>
                <div class="text-center mt-3">  
                  <div class="text-center">
                    <h5 class="mt-2 mb-0">{{ username }}</h5>
                  </div>
                  <div class="user-info mt-3">
                    <div class="recovery-items">
                      <h5>Why do you need a recovery item?</h5>
                      <label>In case you lose your device with the associated passkey we need to ensure you can access your profile with 
                        another method like password or a code sent to your email address
                      </label>
                    </div>
                    <!--
                    <div class="form-group">
                      <label for="email">Email:</label>
                      <input type="email" id="email" placeholder=" {{ email }}" [(ngModel)]="email" class="form-control">
                      <button (click)="saveEmail()" class="btn btn-primary mt-2">Guardar Email</button>
                    </div>
                    -->
                    <div class="form-group mt-3">
                      <label for="password">Contraseña:</label>
                      <input type="password" id="password" 
                             [value]="password" 
                             [(ngModel)]="password" 
                             class="form-control">
                      <button (click)="savePassword()" class="btn btn-primary mt-2">Guardar Contraseña</button>
                    </div>
                    <div *ngIf="errorMessage" class="alert alert-info mt-3">
                      {{ errorMessage }}
                    </div>
                  </div>
                </div>
                <div class="devices-info mt-4">
                  <h5 class="text-center">Registered Passkeys</h5>
                  <ul class="list-group">
                    <li class="list-group-item d-flex justify-content-between align-items-center" *ngFor="let device of devices; let i = index">
                      <div class="device-info">
                        <span class="device-name">{{ device.name }}</span>
                        <div class="device-dates">
                          <small class="text-muted">Created: {{ device.creationDate }}</small>
                          <small class="text-muted">Last used: {{ device.lastUsed | date:'dd/MM/yyyy HH:mm' }}</small>
                        </div>
                      </div>
                      <button class="deleter" (click)="deleteDevice(i)">
                        <i class="bi bi-trash"></i>
                      </button>
                    </li>
                  </ul>
                  <div class="passkey-info mt-4">
                    <p>Passkeys offer a more secure alternative to traditional passwords. They:</p>
                    <ul class="benefits-list">
                      <li>Cannot be phished or stolen</li>
                      <li>Are unique for each website</li>
                      <li>Use biometric authentication</li>
                      <li>Simplify the login process</li>
                    </ul>
                  </div>
                  <div class="passkey-action">
                    <button class="btn btn-outline-primary px-4 add-passkey-btn" (click)="addDevice()" >
                      <i *ngIf="!isLoading"  class="bi bi-plus-circle"></i>
                      <span *ngIf="isLoading" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                      {{ isLoading ? 'Adding...' : 'Add New Passkey' }}
                    </button>
                    <div *ngIf="errorMessage && !isEditing" class="alert alert-danger mt-3"><i class="bi bi-exclamation-triangle"></i>
                      {{ errorMessage }}<i class="bi bi-exclamation-triangle"></i></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>